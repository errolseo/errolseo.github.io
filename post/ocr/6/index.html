<!DOCTYPE html>
<html lang="en-us">
  <head>
    <script type="application/ld+json">

{  
  "@context":"http://schema.org",
  "@type":"Website",
  "@id":"https:\/\/errolseo.github.io\/",
  "author": {
    "@type": "Person",
    "name": "Errol Seo",
    
    "image": "https://errolseo.github.io/images/profile.webp"
    
  },
  "name":"Errol\u0027s AI Lab",
  "description":"About text recognition (with ABINet)",
  "url":"https:\/\/errolseo.github.io\/post\/ocr\/6\/",
  "keywords":"[]"
}

</script>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.151.0 with theme Tranquilpeak 0.5.3-BETA">
<meta name="author" content="Errol Seo">
<meta name="keywords" content="">
<meta name="description" content="About text recognition (with ABINet)">


<meta property="og:description" content="About text recognition (with ABINet)">
<meta property="og:type" content="article">
<meta property="og:title" content="Scene Text Recognition (2/2)">
<meta name="twitter:title" content="Scene Text Recognition (2/2)">
<meta property="og:url" content="https://errolseo.github.io/post/ocr/6/">
<meta property="twitter:url" content="https://errolseo.github.io/post/ocr/6/">
<meta property="og:site_name" content="Errol&#39;s AI Lab">
<meta property="og:description" content="About text recognition (with ABINet)">
<meta name="twitter:description" content="About text recognition (with ABINet)">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2022-05-10T00:00:00">
  
  
    <meta property="article:modified_time" content="2022-05-10T00:00:00">
  
  
  
    
      <meta property="article:section" content="OCR">
    
  
  


<meta name="twitter:card" content="summary">







  <meta property="og:image" content="https://errolseo.github.io/images/profile.webp">
  <meta property="twitter:image" content="https://errolseo.github.io/images/profile.webp">




  <meta property="og:image" content="https://errolseo.github.io/images/OCR/6/2.webp">
  <meta property="twitter:image" content="https://errolseo.github.io/images/OCR/6/2.webp">


    <title>Scene Text Recognition (2/2)</title>

    <link rel="icon" href="https://errolseo.github.io/images/favicon.png">
    

    

    <link rel="canonical" href="https://errolseo.github.io/post/ocr/6/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" integrity="sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xLiPY/NS5R+E6ztJQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Color+Emoji&family=Noto+Sans+KR&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=search" />
    
    
    <link rel="stylesheet" href="https://errolseo.github.io/css/style-0kadtf2j8ubr8zzlihb9hduej968reuzy40j8ddg2zyjhxg3pszkalhyaj.min.css" />
    
    <meta name="google-site-verification" content="FbyrF2ruuSFhnXtsZ-pHu_5BWKYRAKTkXBndFHgWC84" />
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="5">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://errolseo.github.io/" aria-label="Go to homepage">Errol&#39;s AI Lab</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://errolseo.github.io/about" aria-label="Open the link: /about">
    
    
    
      
        <img class="header-picture" src="https://errolseo.github.io/images/profile.webp" alt="Author&#39;s picture" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="5">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <img class="sidebar-profile-picture" src="https://errolseo.github.io/images/profile.webp" alt="Author&#39;s picture" />
        <h4 class="sidebar-profile-name">Errol Seo</h4>
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://errolseo.github.io/" title="Home">
    
      <i class="sidebar-button-icon fas fa-lg fa-home" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://errolseo.github.io/categories" title="Categories">
    
      <i class="sidebar-button-icon fas fa-lg fa-list" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://errolseo.github.io/archives" title="Archives">
    
      <i class="sidebar-button-icon fas fa-lg fa-folder-open" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://errolseo.github.io/about" title="About">
    
      <i class="sidebar-button-icon fas fa-lg fa-user" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/errolseo" target="_blank" rel="noopener" title="GitHub">
    
      <i class="sidebar-button-icon fab fa-lg fa-github" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      <div id="main" data-behavior="5">
        <article class="post" id="top">
          <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title">
      Scene Text Recognition (2/2)
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2022-05-10T00:00:00Z">
        
  May 10, 2022

      </time>
    
    
  
  
    <span>in</span>
    
      <a href="https://errolseo.github.io/categories/ocr">OCR</a>
    
  

  </div>

</div>
          <div class="post-content markdown">
            <div class="main-content-wrap">
              <p>Scene Text Recognition(STR)의 module로써 Language Model(LM)을 사용해 성능을 높히는 경우가 더러 존재한다. 경우에 따르지만 대부분 유의미한 성능 향상을 보여준다. 이는 우리가 다루는 텍스트가 단순히 무작위 문자의 나열이 아닌 <strong>순서에 따라 의미가 바뀌는</strong> 데이터이기 때문이다. 그리고 이런 <strong>언어적 지식</strong>을 텍스트 이미지를 통해 학습하는 것은 한계가 존재한다.</p>
<h4 id="heading">#</h4>
<p>언어적 지식이란 추상적인 개념에 대해 예시를 통해 알아보자. 만약 6면체 주사위를 두 번 던져서 두 눈의 합이 4보다 클지 작을지를 필자에게 예측해 보라고 한다면 클 것 같다고 예측할 것이다. 왜냐하면 주사위의 모든 면이 나올 확률이 동일하다고 할 때, 두 눈의 합은 4보다 클 확률이 작을 확률보다 10배 높기 때문이다. 4보다 작을 확률이 존재하지 않는 것은 아니지만, 크다고 예측하는 것이 정답일 확률이 10배 높다. 텍스트도 마찬가지다.</p>



<div class="figure center" >
  
    <img class="fig-img" src="https://errolseo.github.io/images/OCR/6/1.webp"  alt="Figure 1. Likelihood에 따른 예측 확률 (조, 즈)">
  
   
    <span class="caption">Figure 1. Likelihood에 따른 예측 확률 (조, 즈)</span>
  
</div>

<p>위의 이미지는 노이즈로 인해 &lsquo;치즈&rsquo;와 &lsquo;치조&rsquo; 두 가지 모두 정답일 확률이 존재하며 두 단어는 모두 사전에 등재되어 있다. 하지만 만약 둘 중 하나가 정답이며 선택해 보라고 하면, &lsquo;치조&rsquo;를 고르는 사람보다는 &lsquo;치즈&rsquo;를 고르는 사람이 많을 것이다. 그럼 이 선택은 과연 올바른 선택일까?</p>
<blockquote>
<p>*조* : *즈* = 11,150,298 : 1,104,950<br>
*치조* : *치즈* = 1,070,574 : 115,125<br>
치조 : 치즈 = 0 : 3,804<br>
<br>
2009~2018년 사이에 발행된 신문 기사에서 각 표현이 사용된 횟수 (데이터 출처 : <a href="https://corpus.korean.go.kr/#down">모두의 말뭉치</a>)</p></blockquote>
<p><br>
신문 기사에서 &lsquo;조&rsquo;와 &lsquo;즈&rsquo;가 사용된 횟수에 대해 조사해 보았다. &lsquo;조&rsquo;가 &lsquo;즈&rsquo;에 비해 10배 가까이 많이 사용되었다. &lsquo;조&rsquo;와 &lsquo;즈&rsquo; 사이에서 정답을 예측해야 한다면 &lsquo;조&rsquo;를 선택하는 편이 정답일 확률이 10배 가까이 높다는 것이다. &lsquo;치&rsquo;라는 글자가 앞에 온다 해도 마찬가지다. &lsquo;치조&rsquo;가 &lsquo;치즈&rsquo;보다 10배 가까이 확률이 높다.</p>
<p>하지만 &lsquo;치즈&rsquo;와 &lsquo;치조&rsquo;가 단일 단어로 존재하게 되면 얘기가 달라진다. 표본 집단에서 &lsquo;치조&rsquo;라는 문자가 단일 단어로 사용된 횟수는 0이다. &lsquo;치즈&rsquo;라고 예측하는 편이 월등히 높은 정답 확률을 보장한다.</p>
<h4 id="heading-1">#</h4>
<p>LM이 하는 일은 어디까지나 보정이다. Scene text recognition의 경우, Fig.1처럼 노이즈가 존재하는 이미지는 이미지만으로 정확한 예측이 불가능하다. 그렇기 때문에 노이즈에 대해 얼마나 제대로 예측하냐에 따라 모델의 성능이 크게 갈린다.  <span class="highlight-text primary">LM은 이러한 선택의 갈림길에서 좀 더 높은 확률의 정답을 제시해준다.</span> LM이 하는 일은 정답을 예측하는 일이 아닌 정답의 확률을 제시하는 것이다. 최종적으로는 이미지를 통한 예측 확률과 LM에서의 예측 확률이 합쳐져 최적의 정답을 만들어낸다.</p>
<p>아마 딥 러닝에 대한 조예가 싶다면 STR의 sequentialization 파트가 그 역활을 대신할 수 있는데 왜 LM을 쓰는지 의문을 가질 수 있다. 필자가 생각하는 이상적인 모델 또한 LM을 사용하지 않고 sequentialization 파트에서 이런 지식을 학습하는 것이다. 하지만 그것은 현실적으로 불가능하다. LM에서 다루는 데이터는 텍스트고, STR에서 다루는 데이터는 이미지이기 때문이다. LM에서 다루는 텍스트의 양과 동일한 이미지를 구하는 것도 학습시키는 것도 현실적으로 어렵다.</p>



<div class="figure center" >
  
    <img class="fig-img" src="https://errolseo.github.io/images/OCR/6/2.webp"  alt="Figure 2. (a) Coupled language model / (b) ABINet autonomous language model">
  
   
    <span class="caption">Figure 2. (a) Coupled language model / (b) ABINet autonomous language model</span>
  
</div>

<p>Fig.2의 이미지는 <a href="https://arxiv.org/abs/2103.06495">Autonomous, Bidirectional and Iterative Language Modeling for Scene Text Recognition (ABINet)</a>에서 발췌한 것이다. (a)가 기존 STR 모델이고 (b)가 ABINet에서 채용한 구조이다. 주목할 부분은 LM 입력값의 형태다. 기존 STR 모델은 image feature가 입력이 되고, ABINet은 text가 입력이 된다. 이 차이로 인해 ABINet에서는 pre-trained LM을 사용할 수 있게 되고, 이는 곧 추가적인 <strong>언어적 지식</strong>을 습득하는게 가능하다는 것이다.</p>
<h4 id="heading-2">#</h4>
<p>Language model의 원리는 위에서 다룬 통계적 지식이다. Language model은 단어들의 sequence에 대한 확률을 기억하고 조합을 학습한다. 예를들어 &lsquo;감자튀김&rsquo;이란 단어는 &lsquo;감자&rsquo;와 &lsquo;튀김&rsquo;의 합성어다. 이런 정보를 STR 모델이 scene text image를 통해 자체적으로 학습하는 것은 현재로서는 불가능에 가깝다.</p>
<p>누군가는 STR 모델이란 word box 내의 문자를 텍스트로 변환해 줄 뿐인 모델인데, 어째서 그 언어적 의미까지 알아야 하는가에 대해 의문이 들 수 있다. 사실 문자의 <strong>semantic</strong>을 이해하는 것이 STR 모델에 어떠한 영향을 주는지, 딥러닝의 특성상 정확하게 알 수는 없다. 하지만 확실한 것은 STR 모델에서 semantic이 노이즈로 작용할 이유는 없어 보이며, 수 많은 텍스트와 그 언어적 지식을 학습하는 것은 어떤 형태로든 STR 모델에 도움이 되고 있는 것이 실험으로 증명되고 있다.</p>
<p>LM은 어디까지나 보정의 역활이다. <a href="https://arxiv.org/abs/2112.12916">Graph convolutional
network for Textual Reasoning (GTR)</a>같은 논문에서는 STR을 보정하는 LM을 보정하는 GTR을 개발하고 발표했다. 필자의 생각은 이런 보정 모듈들은 어디까지나 임시 방편이라고 생각한다. 아마 머신 러닝 엔지니어와 사이언티스트들이 이상적으로 생각하는 모습은 아닐 것이다. 하지만 지금 당장은 <strong>선택이 아니라 필수</strong>라고 생각한다.</p>
<h4 id="experience">Experience</h4>
<blockquote>
<p>Model Framework : <a href="https://github.com/FangShancheng/ABINet">https://github.com/FangShancheng/ABINet</a></p></blockquote>
<p><br>
공개된 오픈 소스에서 도커 파일을 함께 제공하고 있기에, LM을 pre-train 하는 것을 제외하고는 문제가 없을 것이라 생각한다. 원본의 경우 LM의 학습에 <a href="https://blog.salesforceairesearch.com/the-wikitext-long-term-dependency-language-modeling-dataset/">WikiText-103</a>를 사용하였는데, 유사한 형태의 한글 데이터가 존재하지 않는다.</p>
<p>Wikitext-103의 경우 100m 규모의 word tokens을, feature article 혹은 good article에서 추출했는데, 한국어 위키에서 feature article에 해당하는 <a href="https://ko.wikipedia.org/wiki/%EC%9C%84%ED%82%A4%EB%B0%B1%EA%B3%BC:%EC%95%8C%EC%B0%AC_%EA%B8%80">알찬 글</a>은 그 규모가 빈약하다.</p>
<p>필자가 생각하기에 가장 좋은 LM의 학습 셋은 본인이 테스트할 도메인에 따라 수집하는 것이 좋으므로, 100m 규모의 어느 정도 <strong>정규화된</strong> word token dataset이면 문제 없을 것이라고 생각한다. 잘 모르겠다면 <a href="https://corpus.korean.go.kr/">모두의 말뭉치</a>나 <a href="https://dumps.wikimedia.org/kowiki/">kowiki dump</a>를 활용하자</p>
<h4 id="reference">Reference</h4>
<p>[1] S. Fang, et al. <a href="https://arxiv.org/abs/2103.06495">Read Like Humans: Autonomous, Bidirectional and Iterative Language Modeling for Scene Text Recognition</a></p>
<p>[2] Y. He, et al. <a href="https://arxiv.org/abs/2112.12916">Visual Semantics Allow for Textual Reasoning Better in Scene Text Recognition</a></p>
<hr>

              


            </div>
          </div>
          
            <div id="post-footer" class="post-footer main-content-wrap">
              
  <script src="https://utteranc.es/client.js"
    repo="errolseo/blog-comments"
    issue-term="title"
    theme="github-light"
    crossorigin="anonymous"
    async>
  </script>


              <div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://errolseo.github.io/post/ocr/5/" data-tooltip="Scene Text Recognition (1/2)" aria-label="PREV: Scene Text Recognition (1/2)">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">PREV</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://errolseo.github.io/post/nlp/1/" data-tooltip="Semantic and Sequence" aria-label="NEXT: Semantic and Sequence">
          
              <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
  <ul class="post-actions post-action-share" >
    
      <li class="post-action hide-lg hide-md hide-sm">
        <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
          <i class="fa fa-share-alt" aria-hidden="true"></i>
        </a>
      </li>
      
    
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#main" aria-label="Back to top">
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
      </a>
    </li>
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#post-footer" aria-label="Leave a comment">
        <i class="far fa-comment"></i>
      </a>
    </li>
  </ul>
</div>

            </div>
          
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; Errol Seo. 2025 All rights reserved.
  </span>
</footer>

      </div>
      
        <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
          <div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://errolseo.github.io/post/ocr/5/" data-tooltip="Scene Text Recognition (1/2)" aria-label="PREV: Scene Text Recognition (1/2)">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">PREV</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://errolseo.github.io/post/nlp/1/" data-tooltip="Semantic and Sequence" aria-label="NEXT: Semantic and Sequence">
          
              <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
  <ul class="post-actions post-action-share" >
    
      <li class="post-action hide-lg hide-md hide-sm">
        <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
          <i class="fa fa-share-alt" aria-hidden="true"></i>
        </a>
      </li>
      
    
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#main" aria-label="Back to top">
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
      </a>
    </li>
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#post-footer" aria-label="Leave a comment">
        <i class="far fa-comment"></i>
      </a>
    </li>
  </ul>
</div>

        </div>
      
    </div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


<script src="https://errolseo.github.io/js/script-ltl7aolmzop70kqwr62fhsf7itglsybdo8brfde7yczi8nbntiwznip2.min.js"></script>




  </body>
</html>
