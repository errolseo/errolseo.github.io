<!DOCTYPE html>
<html lang="en-us">
  <head>
    <script type="application/ld+json">

{  
  "@context":"http://schema.org",
  "@type":"Website",
  "@id":"https:\/\/errolseo.github.io\/",
  "author": {
    "@type": "Person",
    "name": "Errol Seo",
    
    "image": "https://errolseo.github.io/images/profile.webp"
    
  },
  "name":"Errol\u0027s AI Lab",
  "description":"About text recognition (with ABINet)",
  "url":"https:\/\/errolseo.github.io\/post\/ocr\/6\/",
  "keywords":"[]"
}

</script>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.151.0 with theme Tranquilpeak 0.5.3-BETA">
<meta name="author" content="Errol Seo">
<meta name="keywords" content="">
<meta name="description" content="About text recognition (with ABINet)">


<meta property="og:description" content="About text recognition (with ABINet)">
<meta property="og:type" content="article">
<meta property="og:title" content="Scene Text Recognition (2/2)">
<meta name="twitter:title" content="Scene Text Recognition (2/2)">
<meta property="og:url" content="https://errolseo.github.io/post/ocr/6/">
<meta property="twitter:url" content="https://errolseo.github.io/post/ocr/6/">
<meta property="og:site_name" content="Errol&#39;s AI Lab">
<meta property="og:description" content="About text recognition (with ABINet)">
<meta name="twitter:description" content="About text recognition (with ABINet)">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2022-05-10T00:00:00">
  
  
    <meta property="article:modified_time" content="2022-05-10T00:00:00">
  
  
  
    
      <meta property="article:section" content="OCR">
    
  
  


<meta name="twitter:card" content="summary">







  <meta property="og:image" content="https://errolseo.github.io/images/profile.webp">
  <meta property="twitter:image" content="https://errolseo.github.io/images/profile.webp">




  <meta property="og:image" content="https://errolseo.github.io/images/OCR/6/2.webp">
  <meta property="twitter:image" content="https://errolseo.github.io/images/OCR/6/2.webp">


    <title>Scene Text Recognition (2/2)</title>

    <link rel="icon" href="https://errolseo.github.io/images/favicon.png">
    

    

    <link rel="canonical" href="https://errolseo.github.io/post/ocr/6/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" integrity="sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xLiPY/NS5R+E6ztJQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Color+Emoji&family=Noto+Sans+KR&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=search" />
    
    
    <link rel="stylesheet" href="https://errolseo.github.io/css/style-okbyci2fry3yz72m29gprsmertr5xz9vdaxqhjgddy4fcskkc0lq4acof.min.css" />
    
    <meta name="google-site-verification" content="FbyrF2ruuSFhnXtsZ-pHu_5BWKYRAKTkXBndFHgWC84" />
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="5">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://errolseo.github.io/" aria-label="Go to homepage">Errol&#39;s AI Lab</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://errolseo.github.io/about" aria-label="Open the link: /about">
    
    
    
      
        <img class="header-picture" src="https://errolseo.github.io/images/profile.webp" alt="Author&#39;s picture" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="5">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <img class="sidebar-profile-picture" src="https://errolseo.github.io/images/profile.webp" alt="Author&#39;s picture" />
        <h4 class="sidebar-profile-name">Errol Seo</h4>
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://errolseo.github.io/" title="Home">
    
      <i class="sidebar-button-icon fas fa-lg fa-home" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://errolseo.github.io/categories" title="Categories">
    
      <i class="sidebar-button-icon fas fa-lg fa-list" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://errolseo.github.io/archives" title="Archives">
    
      <i class="sidebar-button-icon fas fa-lg fa-folder-open" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://errolseo.github.io/about" title="About">
    
      <i class="sidebar-button-icon fas fa-lg fa-user" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/errolseo" target="_blank" rel="noopener" title="GitHub">
    
      <i class="sidebar-button-icon fab fa-lg fa-github" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      <div id="main" data-behavior="5">
        <article class="post" id="top">
          <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title">
      Scene Text Recognition (2/2)
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2022-05-10T00:00:00Z">
        
  May 10, 2022

      </time>
    
    
  
  
    <span>in</span>
    
      <a href="https://errolseo.github.io/categories/ocr">OCR</a>
    
  

  </div>

</div>
          <div class="post-content markdown">
            <div class="main-content-wrap">
              <p>Scene Text Recognition(STR)의 모듈로써 Language Model(LM)을 사용해 성능을 높이는 경우가 더러 존재합니다. 경우에 따라 다르지만, 대부분 유의미한 성능 향상을 보여줍니다. 이는 우리가 다루는 텍스트가 단순히 무작위 문자의 나열이 아닌, <strong>순서에 따라 의미가 정해지는</strong> 데이터이기 때문입니다. 그리고 이러한 <strong>&lsquo;언어적 지식&rsquo;</strong>을 텍스트 이미지만으로 학습하는 데는 한계가 존재합니다.</p>
<hr>
<h2 id="linguistic">Linguistic</h2>
<p><strong>언어적 지식(Linguistic)</strong>이란 추상적인 개념을 예시를 통해 살펴보겠습니다.</p>
<p>만약 6면체 주사위를 두 번 던져 나오는 눈의 합이 4보다 클지 작을지 예측해야 한다면, <strong>크다</strong>고 예측하는 것이 합리적입니다. 주사위의 모든 면이 나올 확률이 동일하다고 가정할 때, 두 눈의 합이 4보다 클 확률이 작을 확률보다 10배나 높기 때문입니다.</p>
<p>텍스트 인식도 이와 마찬가지입니다.</p>



<div class="figure center" >
  
    <img class="fig-img" src="https://errolseo.github.io/images/OCR/6/1.webp" >
  
  
</div>

<blockquote>
<p>그림 1. Likelihood에 따른 예측 확률 (조, 즈)<br></p></blockquote>
<p>위 이미지처럼 노이즈로 인해 &lsquo;치즈&rsquo;와 &lsquo;치조&rsquo; 두 가지로 모두 읽힐 수 있다고 가정해봅시다. 두 단어 모두 사전에 등재된 표준어입니다. 하지만 둘 중 하나를 정답으로 골라야 한다면, &lsquo;치조&rsquo;보다는 &lsquo;치즈&rsquo;를 고르는 사람이 훨씬 많을 것입니다. 과연 이 선택은 합리적인 근거가 있을까요?</p>
<p>데이터를 통해 확인해 보겠습니다.</p>
<p><strong>2009~2018년 신문 기사 말뭉치 분석 (데이터 출처: 모두의 말뭉치)</strong></p>
<ol>
<li>단일 글자(1-gram) 빈도:
<ul>
<li>&lsquo;조&rsquo; : 11,150,298회</li>
<li>&lsquo;즈&rsquo; : 1,104,950회</li>
<li>&lsquo;조&rsquo;가 &lsquo;즈&rsquo;보다 약 10.1배 많이 사용됨</li>
</ul>
</li>
<li>연속 두 글자(2-gram) 빈도:
<ul>
<li>&lsquo;치조&rsquo; : 1,070,574회</li>
<li>&lsquo;치즈&rsquo; : 115,125회</li>
<li>&lsquo;치조&rsquo;가 &lsquo;치즈&rsquo;보다 약 9.3배 많이 사용됨</li>
</ul>
</li>
<li>단일 단어 빈도:
<ul>
<li>&lsquo;치조&rsquo; : 0회</li>
<li>&lsquo;치즈&rsquo; : 3,804회</li>
<li>&lsquo;치즈&rsquo;만 단일 단어로 사용됨</li>
</ul>
</li>
</ol>
<p>신문 기사 말뭉치에서 단순히 글자 &lsquo;조&rsquo;는 &lsquo;즈&rsquo;보다 10배 넘게 많이 쓰였습니다. 심지어 &lsquo;치&rsquo;라는 글자 바로 뒤에 온다는 조건(&lsquo;치조&rsquo; vs &lsquo;치즈&rsquo;)에서도 &lsquo;치조&rsquo;가 9배 이상 많이 등장했습니다. 이 데이터만 보면, 이미지를 &lsquo;치조&rsquo;로 인식하는 것이 더 확률이 높아 보입니다.</p>
<p>하지만 두 글자가 모여 하나의 단어로 사용되는 경우는 이야기가 완전히 달라집니다. 해당 표본 집단에서 &lsquo;치조&rsquo;가 단일 단어로 사용된 횟수는 0번인 반면, &lsquo;치즈&rsquo;는 3,804번이나 사용되었습니다.</p>
<p>즉, 이 이미지가 &lsquo;치&rsquo;로 시작하는 단일 단어 문맥(context)이 주어지면 &lsquo;치즈&rsquo;라고 예측하는 편이 정답일 확률이 압도적으로 높은 것입니다. 이것이 바로 STR 모델이 이미지 정보만으로는 파악하기 어려운 <strong>언어적 지식</strong>이며, Language Model이 이러한 확률적 문맥을 보정해주는 역할을 합니다.</p>
<hr>
<h2 id="abinet">ABINet</h2>
<p>LM이 하는 일은 어디까지나 <strong>보정(calibration)</strong>입니다. 그림 1의 예시처럼 노이즈가 심한 이미지는 시각 정보(vision model)만으로 정확한 예측이 불가능할 수 있습니다. 이때 LM은 언어적 확률을 제공하여, 모델이 &lsquo;치조&rsquo;와 &lsquo;치즈&rsquo; 같은 선택의 갈림길에 놓였을 때 더 가능성이 높은 정답을 선택하도록 이끌어줍니다. LM이 정답을 직접 예측한다기보다는, 정답일 확률을 보정하는 것입니다. 최종적으로는 이미지를 통한 예측 확률과 LM의 예측 확률이 결합되어 최적의 정답을 도출해냅니다.</p>
<p>물론 이상적인 모델은 LM 없이도 시각 정보만으로 모든 언어적 지식까지 학습하는 것일 겁니다. 하지만 현실적으로는 매우 어렵습니다. LM은 대규모 텍스트 말뭉치로 학습하지만, STR 모델은 텍스트 이미지로 학습하기 때문입니다. LM이 학습하는 방대한 양의 텍스트와 동일한 규모의 이미지 데이터를 구하고, 이를 STR 모델에 모두 학습시키는 것은 현실적으로 불가능에 가깝습니다.</p>



<div class="figure center" >
  
    <img class="fig-img" src="https://errolseo.github.io/images/OCR/6/2.webp" >
  
  
</div>

<blockquote>
<p>그림 2. (a) Coupled language model / (b) ABINet autonomous language model<br>
<a href="https://arxiv.org/abs/2103.06495">Shancheng Fang, et al. (2021)</a></p></blockquote>
<p>그림 2에서 가장 주목할 부분은 LM의 입력값입니다. (a)는 이미지 특징(image feature)을 LM의 입력으로 사용하지만, (b)는 텍스트(text)를 입력으로 받습니다. 이 구조적 차이 덕분에, (b)는 거대한 텍스트 말뭉치로 미리 학습된 pre-trained LM을 STR 모델에 결합하는 것을 가능하게 합니다. 이는 곧, 모델 외부에 존재하는 방대한 언어적 지식을 효과적으로 주입할 수 있다는 의미입니다.</p>
<hr>
<h2 id="conclusion">Conclusion</h2>
<p>Language Model(LM)의 기본 원리는 위에서 다룬 통계적 지식에 기반합니다. LM은 단어들의 sequence에 대한 확률을 기억하고 단어 조합을 학습합니다. 예를 들어, &lsquo;감자튀김&rsquo;이란 단어는 &lsquo;감자&rsquo;와 &lsquo;튀김&rsquo;의 합성어입니다. 이런 시맨틱(semantic) 정보를 STR 모델이 scene text image를 통해 자체적으로 학습하는 것은 현재로서는 불가능에 가깝습니다.</p>
<p>STR 모델은 단순히 word box 안의 문자를 텍스트로 변환할 뿐인데, 왜 언어적 의미까지 알아야 하는지에 대한 의문을 가질 수도 있습니다. 사실 문자의 시맨틱을 이해하는 것이 STR 모델에 정확히 어떤 영향을 주는지는 명확히 추적하기는 어렵습니다. 하지만 확실한 것은, 수많은 텍스트와 그 언어적 지식을 학습하는 것은 어떤 형태로든 STR 모델에 도움이 된다는 것이 실험을 통해 증명되고 있습니다.</p>
<p>LM은 어디까지나 <strong>보정</strong>의 역할입니다. Graph Convolutional Network for Textual Reasoning(GTR) 같은 논문에서는, STR을 보정하는 LM을 다시 보정하는 GTR을 개발하여 발표하기도 했습니다. 이러한 보정 모듈들은 임시방편일 수 있습니다. 아마 머신 러닝 엔지니어와 사이언티스트들이 이상적으로 생각하는 모습은 아닐 것입니다. 하지만 지금 당장은 <strong>선택이 아닌 필수</strong>라고 생각합니다.</p>
<hr>
<h4 id="reference">Reference</h4>
<p>Fang, Shancheng (2021) | <a href="https://arxiv.org/abs/2103.06495">Read Like Humans: Autonomous, Bidirectional and Iterative Language Modeling for Scene Text Recognition</a></p>
<p>He, Yue (2021) | <a href="https://arxiv.org/abs/2112.12916">Visual Semantics Allow for Textual Reasoning Better in Scene Text Recognition</a></p>
<hr>

              


            </div>
          </div>
          
            <div id="post-footer" class="post-footer main-content-wrap">
              
  <script src="https://utteranc.es/client.js"
    repo="errolseo/blog-comments"
    issue-term="title"
    theme="github-light"
    crossorigin="anonymous"
    async>
  </script>


              <div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://errolseo.github.io/post/ocr/5/" data-tooltip="Scene Text Recognition (1/2)" aria-label="PREV: Scene Text Recognition (1/2)">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">PREV</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://errolseo.github.io/post/nlp/1/" data-tooltip="Semantic and Sequence" aria-label="NEXT: Semantic and Sequence">
          
              <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
  <ul class="post-actions post-action-share" >
    
      <li class="post-action hide-lg hide-md hide-sm">
        <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
          <i class="fa fa-share-alt" aria-hidden="true"></i>
        </a>
      </li>
      
    
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#main" aria-label="Back to top">
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
      </a>
    </li>
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#post-footer" aria-label="Leave a comment">
        <i class="far fa-comment"></i>
      </a>
    </li>
  </ul>
</div>

            </div>
          
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; Errol Seo. 2025 All rights reserved.
  </span>
</footer>

      </div>
      
        <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
          <div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://errolseo.github.io/post/ocr/5/" data-tooltip="Scene Text Recognition (1/2)" aria-label="PREV: Scene Text Recognition (1/2)">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">PREV</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://errolseo.github.io/post/nlp/1/" data-tooltip="Semantic and Sequence" aria-label="NEXT: Semantic and Sequence">
          
              <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
  <ul class="post-actions post-action-share" >
    
      <li class="post-action hide-lg hide-md hide-sm">
        <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
          <i class="fa fa-share-alt" aria-hidden="true"></i>
        </a>
      </li>
      
    
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#main" aria-label="Back to top">
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
      </a>
    </li>
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#post-footer" aria-label="Leave a comment">
        <i class="far fa-comment"></i>
      </a>
    </li>
  </ul>
</div>

        </div>
      
    </div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


<script src="https://errolseo.github.io/js/script-rmctkti4ivrizhnkuifyecc3kfjeenwbkfkende6oyeiwd0wwkg7qv4wbs.min.js"></script>




  </body>
</html>
