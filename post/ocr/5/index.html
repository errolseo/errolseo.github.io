<!DOCTYPE html>
<html lang="en-us">
  <head>
    <script type="application/ld+json">

{  
  "@context":"http://schema.org",
  "@type":"Website",
  "@id":"https:\/\/errolseo.github.io\/",
  "author": {
    "@type": "Person",
    "name": "Errol Seo",
    
    "image": "https://errolseo.github.io/images/profile.webp"
    
  },
  "name":"Errol\u0027s AI Lab",
  "description":"문자 인식 모델에 대한 설명 (with. CRNN, SRN)",
  "url":"https:\/\/errolseo.github.io\/post\/ocr\/5\/",
  "keywords":"[]"
}

</script>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.151.0 with theme Tranquilpeak 0.5.3-BETA">
<meta name="author" content="Errol Seo">
<meta name="keywords" content="">
<meta name="description" content="문자 인식 모델에 대한 설명 (with. CRNN, SRN)">


<meta property="og:description" content="문자 인식 모델에 대한 설명 (with. CRNN, SRN)">
<meta property="og:type" content="article">
<meta property="og:title" content="Scene Text Recognition (1/2)">
<meta name="twitter:title" content="Scene Text Recognition (1/2)">
<meta property="og:url" content="https://errolseo.github.io/post/ocr/5/">
<meta property="twitter:url" content="https://errolseo.github.io/post/ocr/5/">
<meta property="og:site_name" content="Errol&#39;s AI Lab">
<meta property="og:description" content="문자 인식 모델에 대한 설명 (with. CRNN, SRN)">
<meta name="twitter:description" content="문자 인식 모델에 대한 설명 (with. CRNN, SRN)">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2022-04-26T00:00:00">
  
  
    <meta property="article:modified_time" content="2022-04-26T00:00:00">
  
  
  
    
      <meta property="article:section" content="OCR">
    
  
  


<meta name="twitter:card" content="summary">







  <meta property="og:image" content="https://errolseo.github.io/images/profile.webp">
  <meta property="twitter:image" content="https://errolseo.github.io/images/profile.webp">




  <meta property="og:image" content="https://errolseo.github.io/images/OCR/5/1.webp">
  <meta property="twitter:image" content="https://errolseo.github.io/images/OCR/5/1.webp">


    <title>Scene Text Recognition (1/2)</title>

    <link rel="icon" href="https://errolseo.github.io/images/favicon.png">
    

    

    <link rel="canonical" href="https://errolseo.github.io/post/ocr/5/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" integrity="sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xLiPY/NS5R+E6ztJQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Color+Emoji&family=Noto+Sans+KR&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=search" />
    
    
    <link rel="stylesheet" href="https://errolseo.github.io/css/style-okbyci2fry3yz72m29gprsmertr5xz9vdaxqhjgddy4fcskkc0lq4acof.min.css" />
    
    <meta name="google-site-verification" content="FbyrF2ruuSFhnXtsZ-pHu_5BWKYRAKTkXBndFHgWC84" />
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="5">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://errolseo.github.io/" aria-label="Go to homepage">Errol&#39;s AI Lab</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://errolseo.github.io/about" aria-label="Open the link: /about">
    
    
    
      
        <img class="header-picture" src="https://errolseo.github.io/images/profile.webp" alt="Author&#39;s picture" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="5">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <img class="sidebar-profile-picture" src="https://errolseo.github.io/images/profile.webp" alt="Author&#39;s picture" />
        <h4 class="sidebar-profile-name">Errol Seo</h4>
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://errolseo.github.io/" title="Home">
    
      <i class="sidebar-button-icon fas fa-lg fa-home" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://errolseo.github.io/categories" title="Categories">
    
      <i class="sidebar-button-icon fas fa-lg fa-list" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://errolseo.github.io/archives" title="Archives">
    
      <i class="sidebar-button-icon fas fa-lg fa-folder-open" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://errolseo.github.io/about" title="About">
    
      <i class="sidebar-button-icon fas fa-lg fa-user" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/errolseo" target="_blank" rel="noopener" title="GitHub">
    
      <i class="sidebar-button-icon fab fa-lg fa-github" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      <div id="main" data-behavior="5">
        <article class="post" id="top">
          <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title">
      Scene Text Recognition (1/2)
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2022-04-26T00:00:00Z">
        
  April 26, 2022

      </time>
    
    
  
  
    <span>in</span>
    
      <a href="https://errolseo.github.io/categories/ocr">OCR</a>
    
  

  </div>

</div>
          <div class="post-content markdown">
            <div class="main-content-wrap">
              <p>장면 문자 인식(Scene Text Recognition, STR)은 기본적인 이미지 분류(Image classification) 작업과 유사하게 동작합니다. 이미지 분류 모델이 이미지를 입력받아 해당 이미지의 분류 라벨을 출력하는 것처럼, STR 모델은 이미지를 입력받아 이미지 안의 글자 라벨을 출력합니다. 여기서 한 가지 다른 점은 일반적인 이미지 분류 작업의 라벨에는 <strong>&lsquo;시퀀스(sequence)&rsquo;</strong> 정보가 없다는 것 입니다.</p>
<p>예를들어, 강아지, 고양이, 거북이를 분류하는 이미지 분류 모델이 있다고 가정해봅시다. 해당 모델은 강아지와 고양이 그리고 거북이를 잘 분류할 수 있으며, 두 종류 이상의 동물이 같이 등장해도 잘 분류할 수 있습니다. 하지만 이 모델에게 강아지가 먼저 나타났는지 고양이가 먼저 나타났는지는 중요하지 않습니다. 단지 이미지 내에 해당 동물이 &lsquo;존재하는지&rsquo; 여부만이 중요하기 때문입니다.</p>
<p>하지만 언어는 그렇지 않습니다. <span class="highlight-text primary">'On'과 'No'가 완전히 다른 의미인 것처럼, 이미지에 알파벳 'a'가 등장하는지 여부도 중요하지만 몇 번째 순서에 등장하는지 또한 굉장히 중요합니다.</span></p>
<hr>
<h2 id="crnn">CRNN</h2>
<p>2015년에 공개된 <strong>Convolutional Recurrent Neural Network(CRNN)</strong>은 STR 모델을 Convolutional Layers, Recurrent Layers, Transcription Layer의 3 단계의 레이어로 구성하는 방법을 제시했습니다.</p>



<div class="figure center" >
  
    <img class="fig-img" src="https://errolseo.github.io/images/OCR/5/1.webp" >
  
  
</div>

<blockquote>
<p>그림 1. Convolutional Recurrent Neural Network<br>
<a href="https://arxiv.org/abs/1507.05717">Baoguang Shi (2015)</a></p></blockquote>
<p>그림 1의 CRNN 모델 아키텍처를 보면, 1단계 Convolutional Layers는 CNN을 활용해 입력을 인코딩하는 작업을 수행합니다. 이는 곧 이미지의 특징(feature)을 추출하는 단계라고 할 수 있습니다. 2단계 Recurrent Layers는 RNN을 활용하여 추출된 특징에 시퀀스(sequence) 정보를 추가합니다. 모델이 실제 예측(Prediction) 시에 전후 입력 정보를 직접 고려하지 않기 때문에, 미리 앞뒤 픽셀에 대한 정보를 반영해주는 역할을 합니다. 마지막으로 3단계 Transcription Layer에서는 <strong>Connection Temporal Classification(CTC)</strong>를 이용해 최종 예측을 수행합니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#111">inp</span> <span style="color:#f92672">=</span> <span style="color:#111">torch</span><span style="color:#f92672">.</span><span style="color:#111">randn</span><span style="color:#111">([</span><span style="color:#111">batch</span><span style="color:#111">,</span> <span style="color:#ae81ff">3</span><span style="color:#111">,</span> <span style="color:#111">height</span><span style="color:#111">,</span> <span style="color:#111">width</span><span style="color:#111">])</span> <span style="color:#75715e"># [b, 3, h, w]</span>
</span></span><span style="display:flex;"><span><span style="color:#111">cnn_oup</span> <span style="color:#f92672">=</span> <span style="color:#111">cnn_layer</span><span style="color:#111">(</span><span style="color:#111">inp</span><span style="color:#111">)</span> <span style="color:#75715e"># [b, c_c, c_h, c_w]</span>
</span></span><span style="display:flex;"><span><span style="color:#111">rnn_inp</span> <span style="color:#f92672">=</span> <span style="color:#111">cnn_oup</span><span style="color:#f92672">.</span><span style="color:#111">permute</span><span style="color:#111">(</span><span style="color:#ae81ff">0</span><span style="color:#111">,</span> <span style="color:#ae81ff">3</span><span style="color:#111">,</span> <span style="color:#ae81ff">1</span><span style="color:#111">,</span> <span style="color:#ae81ff">2</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">view</span><span style="color:#111">(</span><span style="color:#111">b</span><span style="color:#111">,</span> <span style="color:#111">c_w</span><span style="color:#111">,</span> <span style="color:#111">c_c</span> <span style="color:#f92672">*</span> <span style="color:#111">c_h</span><span style="color:#111">)</span> <span style="color:#75715e"># [b, c_w, c_c * c_h]</span>
</span></span><span style="display:flex;"><span><span style="color:#111">rnn_oup</span> <span style="color:#f92672">=</span> <span style="color:#111">rnn_layer</span><span style="color:#111">(</span><span style="color:#111">rnn_inp</span><span style="color:#111">,</span> <span style="color:#111">batch_first</span><span style="color:#f92672">=</span><span style="color:#00a8c8">True</span><span style="color:#111">)</span> <span style="color:#75715e"># [b, c_w, hidden_size]</span>
</span></span><span style="display:flex;"><span><span style="color:#111">pred_oup</span> <span style="color:#f92672">=</span> <span style="color:#111">prediction</span><span style="color:#111">(</span><span style="color:#111">rnn_oup</span><span style="color:#111">)</span> <span style="color:#75715e"># [b, c_w, num_labels]</span>
</span></span></code></pre></div><p>모델 내의 데이터 흐름(flow)은 코드를 통해 살펴보면 더 직관적입니다. Line 1과 2에서는 3채널의 RGB 이미지를 입력으로 받아 CNN 레이어에 통과시키는 과정을 확인할 수 있습니다. 이 때 각 라인의 주석은 출력 형태(shape)를 의미합니다. Line 3과 4에서는 <code>c_w</code> 단위로 RNN 레이어를 통과하는 과정을 확인할 수 있습니다. 마지막으로 Line 5에서 prediction function을 통과하면 최종 출력은 <code>[b, c_w, num_labels]</code>가 됩니다.</p>
<hr>
<h3 id="feature-maps">Feature Maps</h3>
<p><strong>Feature Map 추출</strong>은 데이터 인코딩과 동일한 과정입니다. CRNN에서는 CNN 레이어를 사용했지만, 최근 모델에선 transformer block을 활용해 준수한 성능을 보여주기도 합니다. 하지만 transformer block은 연산량 증가로 인한 추론 속도 저하라는 trade off가 발생합니다. 이러한 문제점에 비해 <strong>EfficientNet</strong>과 같이 최적화된 CNN 모델에 비해 성능이 더 좋다고 단정하기도 어렵습니다.</p>
<p>따라서 모바일 환경과 같은 소형 기기에서는 CNN 레이어를 활용한 소형 모델로도 충분할 것입니다. 반면 성능이 매우 중요하다면 대량의 데이터로 transformer block 기반의 OCR 모델을 학습시키는 것도 좋은 방법이 될 수 있습니다.</p>
<hr>
<h3 id="connection-temporal-classification">Connection Temporal Classification</h3>
<p>CTC를 사용하는 핵심적인 이유는 모델의 출력 시퀀스 길이가 정답 시퀀스보다 훨씬 길 수 있다는 점입니다. 그림 1의 예시를 보면, 모델은 &lsquo;state(5)&lsquo;라는 정답을 얻기 위해 &lsquo;-s-t-aatte-&rsquo;(11, <code>c_w</code>)와 같은 긴 정답 시퀀스를 생성했습니다.</p>
<p>CTC는 이 모든 경우의 수를 동적 프로그래밍(Dynamic Programing, DP)을 사용해 모든 정답 시퀀스 중에 가장 높은 확률을 갖는 정답 시퀀스를 찾아냅니다. 좀 더 상세한 알고리즘은 <a href="https://ratsgo.github.io/speechbook/docs/neuralam/ctc">Connectionist Temporal Classification(ratsgo&rsquo;s SPEECH BOOK)</a>을 살펴보는 것을 추천드립니다.</p>
<hr>
<h3 id="sequence">Sequence</h3>
<p>최근에는 CTC가 아닌 Auto Regressive(AR) 모델을 이용해서 추론하는 것이 더 주된 방법입니다. 그림 1의 Recurrent Layers에는 인코딩 과정만 있고 디코딩 과정이 빠져있습니다. <strong>Sequence Recognition Network(SRN)</strong>에서는 CRNN에선 빠졌던 RNN 디코더를 사용해 정답 시퀀스를 추론했습니다.</p>



<div class="figure center" >
  
    <img class="fig-img" src="https://errolseo.github.io/images/OCR/5/2.webp" >
  
  
</div>

<blockquote>
<p>그림 2. Sequence Recognition Network<br>
<a href="https://arxiv.org/abs/1603.03915">Baoguang Shi (2016)</a></p></blockquote>
<p>RNN 디코더를 사용했을 때의 가장 큰 장점은 언어적 맥락을 활용할 수 있다는 점입니다. CTC와 달리, RNN 디코더는 &lsquo;he&rsquo;가 생성된 후 &rsquo;llo&rsquo;가 나올 확률이 높다는 것을 모델이 학습합니다. 이는 이미지가 손상되어 &lsquo;hellc&rsquo;처럼 보이더라도 우리가 &lsquo;hello&rsquo;라고 읽는 것처럼, 노이즈(noise)에 강건한(robust) 성능을 보여줍니다. 그 밖에도 Attention 메커니즘과 <EOS> 토큰을 활용하여 출력 길이를 자유롭게 조정할 수 있는 등의 다양한 장점이 있습니다.</p>
<hr>
<h4 id="reference">Reference</h4>
<p>Baek, Jeonghun (2019) | <a href="https://arxiv.org/abs/1904.01906">What Is Wrong With Scene Text Recognition Model Comparisons? Dataset and Model Analysis</a></p>
<p>Graves, Alex (2006) | <a href="https://www.cs.toronto.edu/~graves/icml_2006.pdf">Connectionist Temporal Classification: Labelling Unsegmented Sequence Data with Recurrent Neural Networks</a></p>
<p>Shi, Baoguang (2015) | <a href="https://arxiv.org/abs/1507.05717">An End-to-End Trainable Neural Network for Image-based Sequence Recognition and Its Application to Scene Text Recognition</a></p>
<p>Shi, Baoguang (2016) | <a href="https://arxiv.org/abs/1603.03915">Robust Scene Text Recognition with Automatic Rectification</a></p>
<p><a href="https://github.com/HCIILAB/Scene-Text-Recognition-Recommendations">Scene Text Recognition Recommendations</a></p>
<hr>

              


            </div>
          </div>
          
            <div id="post-footer" class="post-footer main-content-wrap">
              
  <script src="https://utteranc.es/client.js"
    repo="errolseo/blog-comments"
    issue-term="title"
    theme="github-light"
    crossorigin="anonymous"
    async>
  </script>


              <div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://errolseo.github.io/post/ocr/4/" data-tooltip="Synthetic Text Image (3/3)" aria-label="PREV: Synthetic Text Image (3/3)">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">PREV</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://errolseo.github.io/post/ocr/6/" data-tooltip="Scene Text Recognition (2/2)" aria-label="NEXT: Scene Text Recognition (2/2)">
          
              <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
  <ul class="post-actions post-action-share" >
    
      <li class="post-action hide-lg hide-md hide-sm">
        <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
          <i class="fa fa-share-alt" aria-hidden="true"></i>
        </a>
      </li>
      
    
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#main" aria-label="Back to top">
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
      </a>
    </li>
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#post-footer" aria-label="Leave a comment">
        <i class="far fa-comment"></i>
      </a>
    </li>
  </ul>
</div>

            </div>
          
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; Errol Seo. 2025 All rights reserved.
  </span>
</footer>

      </div>
      
        <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
          <div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://errolseo.github.io/post/ocr/4/" data-tooltip="Synthetic Text Image (3/3)" aria-label="PREV: Synthetic Text Image (3/3)">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">PREV</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://errolseo.github.io/post/ocr/6/" data-tooltip="Scene Text Recognition (2/2)" aria-label="NEXT: Scene Text Recognition (2/2)">
          
              <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
  <ul class="post-actions post-action-share" >
    
      <li class="post-action hide-lg hide-md hide-sm">
        <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
          <i class="fa fa-share-alt" aria-hidden="true"></i>
        </a>
      </li>
      
    
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#main" aria-label="Back to top">
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
      </a>
    </li>
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#post-footer" aria-label="Leave a comment">
        <i class="far fa-comment"></i>
      </a>
    </li>
  </ul>
</div>

        </div>
      
    </div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


<script src="https://errolseo.github.io/js/script-rmctkti4ivrizhnkuifyecc3kfjeenwbkfkende6oyeiwd0wwkg7qv4wbs.min.js"></script>




  </body>
</html>
